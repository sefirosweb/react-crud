import{j as a}from"./ThemeProvider-a71a5aa9.js";import{r as h}from"./index-61bf1805.js";import{M as P}from"./index-086f44c1.js";import{F as b}from"./index-2675dd19.js";import{F as f}from"./index-11f483a8.js";import{u as N,M as k}from"./index-1406dde3.js";import{a as T}from"./axios-94372f69.js";import{u as Q,Q as z}from"./useGetQueryClient-cbcca069.js";import{u as B}from"./useTranslation-9aad8729.js";import{F as L}from"./Form-6057eae6.js";const ne=(s,l)=>new Promise((r,d)=>{if(!s){r(null);return}T.get(s,{params:l}).then(p=>r(p.data)).catch(d)}),W=s=>{const{crud:l,modalDataToSend:r,url:d}=s;return new Promise((p,n)=>{switch(l){case"CREATE":T.post(d,r).then(u=>{if(u.data.success!==!0)return n("The response dosen't response success");p(u.data)}).catch(n);break;case"DELETE":T.delete(d,{data:r}).then(u=>{if(u.data.success!==!0)return n("The response dosen't response success");p(u.data)}).catch(n);break;case"UPDATE":T.put(d,r).then(u=>{if(u.data.success!==!0)return n("The response dosen't response success");p(u.data)}).catch(n);break}})},w=s=>{const l={};return s.forEach(r=>{r.accessorKey&&(l[r.accessorKey]=r)}),l},G=s=>{const{show:l,setShow:r,title:d,accept:p,fields:n,url:u,handleSuccess:K,crud:c,primaryKey:E,sentKeyAs:O="",titleOnDelete:D}=s,q=O??E,[S,g]=h.useState(!1),[U,C]=h.useState("info"),[o,V]=h.useState(w(n)),{t:M}=B(),{mutate:_}=N({mutationFn:W});h.useEffect(()=>{const t=w(n);V(t)},[n]),h.useEffect(()=>{switch(c){case"CREATE":C("success");break;case"UPDATE":C("warning");break;case"DELETE":C("danger");break}},[c]);const A=t=>{const e=t.target.name,m=t.target.value,i={...o},y=i[e];y&&(y.fieldType!==f.MULTISELECT&&(y.data=m),V(i))},v=(t,e)=>{const m={...o},i=m[e];if(i){if(i.fieldType===f.MULTISELECT){const y=t.map(R=>R.value);i.data=y}V(m)}},F=()=>{g(!0);const t={};n.filter(e=>e.editable||e.accessorKey===E).forEach(e=>{e.accessorKey&&(t[e.accessorKey]=o[e.accessorKey].data??"")}),q&&(t[q]=t[E]),_({crud:c,modalDataToSend:t,url:u},{onSuccess:e=>{r(!1),g(!1),K&&{}.toString.call(K)==="[object Function]"&&K(e,c)},onError:()=>{g(!1)}})},j=()=>{var t;return c==="DELETE"?a.jsxs("span",{children:[a.jsxs("p",{children:[M("messages.confirm_delete"),": ",o[E].data]}),D&&((t=o[D])==null?void 0:t.data)&&a.jsx("p",{children:o[D].data})]}):null},I=()=>a.jsxs(a.Fragment,{children:[a.jsxs(L,{children:[n.map(t=>{if(!t.accessorKey||!t.editable)return null;const e=o[t.accessorKey];return!e||!e.accessorKey?null:e.accessorKey===E?a.jsx(L.Control,{type:"hidden",name:"primaryKey",value:e.data??""},e.accessorKey):c==="DELETE"||e.fieldType===f.MULTISELECT?null:e.fieldType===f.SELECT?a.jsx(b,{type:e.fieldType,name:e.accessorKey,controlId:e.accessorKey,label:e.titleOnCRUD??e.accessorKey,isLoading:S,handleChange:A,value:e.data,selectOptionsUrl:e.selectOptionsUrl??"",className:"mb-2"},e.accessorKey):a.jsx(b,{type:e.fieldType??f.TEXT,name:e.accessorKey,controlId:e.accessorKey,label:e.titleOnCRUD??e.accessorKey,isLoading:S,handleChange:A,value:e.data,className:"mb-2"},e.accessorKey)}),j()]}),n.map(t=>{var i;if(c==="DELETE"||!t.multiSelectOptions||!t.accessorKey)return null;const e=o[t.accessorKey];if(!(e!=null&&e.accessorKey)||e.fieldType!==f.MULTISELECT)return null;let m="";return c==="UPDATE"&&(m=((i=e.multiSelectOptions)==null?void 0:i.url)??""),a.jsx(k,{label:e.titleOnCRUD??e.accessorKey,columns:t.multiSelectOptions.columns,crudUrl:m,getDataUrl:e.multiSelectOptions.getDataUrl,sentKeyAs:e.multiSelectOptions.sentKeyAs,primaryKey:e.multiSelectOptions.primaryKey,primaryKeyId:"",lazyLoad:e.multiSelectOptions.lazyLoad,autoSave:!1,handleChange:y=>v(y,e.accessorKey)},e.accessorKey)})]});return a.jsx(a.Fragment,{children:a.jsx(P,{show:l,setShow:r,handleAccept:F,body:I(),title:d,isLoading:S,accept:p??M("Accept"),acceptVariant:U})})},x=s=>{const l=Q();return a.jsx(z,{client:l,children:a.jsx(G,{...s})})};try{x.displayName="ModalCrud",x.__docgenInfo={description:"",displayName:"ModalCrud",props:{accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string"}},show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},setShow:{defaultValue:null,description:"",name:"setShow",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},handleSuccess:{defaultValue:null,description:"",name:"handleSuccess",required:!1,type:{name:"((response: any, crud: CrudType) => void)"}},crud:{defaultValue:null,description:"",name:"crud",required:!0,type:{name:"enum",value:[{value:'"CREATE"'},{value:'"UPDATE"'},{value:'"DELETE"'}]}},titleOnDelete:{defaultValue:null,description:"",name:"titleOnDelete",required:!1,type:{name:"string"}},primaryKey:{defaultValue:null,description:"",name:"primaryKey",required:!0,type:{name:"string"}},sentKeyAs:{defaultValue:null,description:"",name:"sentKeyAs",required:!1,type:{name:"string"}},fields:{defaultValue:null,description:"",name:"fields",required:!0,type:{name:"ColumnDefinition<any>[]"}}}}}catch{}try{ModalCrud.displayName="ModalCrud",ModalCrud.__docgenInfo={description:"",displayName:"ModalCrud",props:{accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string"}},show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},setShow:{defaultValue:null,description:"",name:"setShow",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},handleSuccess:{defaultValue:null,description:"",name:"handleSuccess",required:!1,type:{name:"((response: any, crud: CrudType) => void)"}},crud:{defaultValue:null,description:"",name:"crud",required:!0,type:{name:"enum",value:[{value:'"CREATE"'},{value:'"UPDATE"'},{value:'"DELETE"'}]}},titleOnDelete:{defaultValue:null,description:"",name:"titleOnDelete",required:!1,type:{name:"string"}},primaryKey:{defaultValue:null,description:"",name:"primaryKey",required:!0,type:{name:"string"}},sentKeyAs:{defaultValue:null,description:"",name:"sentKeyAs",required:!1,type:{name:"string"}},fields:{defaultValue:null,description:"",name:"fields",required:!0,type:{name:"ColumnDefinition<any>[]"}}}}}catch{}export{x as M,ne as g};
//# sourceMappingURL=index-b11ed130.js.map
